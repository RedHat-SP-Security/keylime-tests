summary: Tests agent registration with non-default TPM algorithms
description: |
    Running all services on localhost.
    Uses certificates generated by keylime.
    Configures tenant and agent to use non-default TPM algorithms
    Starts verifier, registrar, agent.
    Registers agent and verifies successful registration.
contact: Karel Srot <ksrot@redhat.com>
component:
  - keylime
test: ./test.sh
framework: beakerlib
tag:
  - CI-Tier-1
require:
  - yum
recommend:
  - keylime
duration: 5m
enabled: true

adjust+:
  # we require SWTPM
  - when: swtpm == no
    enabled: false

# this is not a complete set possible variants
/rsa2048-rsassa:
  summary: Tests agent registration with rsa2048-rsassa TPM algorithms
  environment:
    TPM_ENCRYPTION_ALG: rsa2048
    TPM_SIGNING_ALG: rsassa

/rsa3072-rsapss:
  summary: Tests agent registration with rsa3072-rsapss TPM algorithms
  environment:
    TPM_ENCRYPTION_ALG: rsa3072
    TPM_SIGNING_ALG: rsapss

/ecc256-ecschnorr:
  summary: Tests agent registration with ecc256-ecschnorr TPM algorithms
  environment:
    TPM_ENCRYPTION_ALG: ecc256
    TPM_SIGNING_ALG: ecschnorr

/ecc384-ecschnorr:
  summary: Tests agent registration with ecc384-ecschnorr TPM algorithms
  environment:
    TPM_ENCRYPTION_ALG: ecc384
    TPM_SIGNING_ALG: ecschnorr

# not working yet
#/ecc521-ecdsa:
#  summary: Tests agent registration with ecc521-ecdsa TPM algorithms
#  environment:
#    TPM_ENCRYPTION_ALG: ecc521
#    TPM_SIGNING_ALG: ecdsa
