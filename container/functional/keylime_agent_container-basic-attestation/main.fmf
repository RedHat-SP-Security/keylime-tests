summary: Tests basic keylime attestation scenario for keylime agent container
description: |
    Running only verifier and registrar on localhost. Agents run in containers.
    Uses certificates generated by keylime.
    Starts verifier, registrar on localhost.
    Build container image with agent. 
    Setup agent conf for each container.
    Run container with agent.
    Register agent by verifier.
    Verifiers that container passed with agent attestation.
    Do changes in scripts monitored by agents and confirm they fail attestation accordingly.    
contact: Patrik Koncity <pkoncity@redhat.com>
tag:
  - container
component:
  - keylime
test: ./test.sh
framework: beakerlib
require:
  - yum
  - podman
recommend:
  - keylime
duration: 10m
enabled: true
adjust:
  - when: swtpm != yes
    enabled: false
    because: We need to emulate multiple TPM devices with swtpm
/push:
    environment:
        AGENT_SERVICE: PushAgent
    id: be2bbaa2-f97a-4ad9-bd03-2eb6a1dac0e5
/pull:
    environment:
        AGENT_SERVICE: Agent
    id: 3b782552-e418-4b35-86c3-d346cb8b0442
